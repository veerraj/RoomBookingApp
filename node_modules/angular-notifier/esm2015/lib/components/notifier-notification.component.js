/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, Input, Output, Renderer2 } from '@angular/core';
import { NotifierAnimationService } from '../services/notifier-animation.service';
import { NotifierNotification } from '../models/notifier-notification.model';
import { NotifierService } from '../services/notifier.service';
import { NotifierTimerService } from '../services/notifier-timer.service';
/**
 * Notifier notification component
 * -------------------------------
 * This component is responsible for actually displaying the notification on screen. In addition, it's able to show and hide this
 * notification, in particular to animate this notification in and out, as well as shift (move) this notification vertically around.
 * Furthermore, the notification component handles all interactions the user has with this notification / component, such as clicks and
 * mouse movements.
 */
export class NotifierNotificationComponent {
    /**
     * Constructor
     *
     * @param {?} elementRef               Reference to the component's element
     * @param {?} renderer                 Angular renderer
     * @param {?} notifierService          Notifier service
     * @param {?} notifierTimerService     Notifier timer service
     * @param {?} notifierAnimationService Notifier animation service
     */
    constructor(elementRef, renderer, notifierService, notifierTimerService, notifierAnimationService) {
        this.config = notifierService.getConfig();
        this.ready = new EventEmitter();
        this.dismiss = new EventEmitter();
        this.timerService = notifierTimerService;
        this.animationService = notifierAnimationService;
        this.renderer = renderer;
        this.element = elementRef.nativeElement;
        this.elementShift = 0;
    }
    /**
     * Component after view init lifecycle hook, setts up the component and then emits the ready event
     * @return {?}
     */
    ngAfterViewInit() {
        this.setup();
        this.elementHeight = this.element.offsetHeight;
        this.elementWidth = this.element.offsetWidth;
        this.ready.emit(this);
    }
    /**
     * Get the notifier config
     *
     * @return {?} Notifier configuration
     */
    getConfig() {
        return this.config;
    }
    /**
     * Get notification element height (in px)
     *
     * @return {?} Notification element height (in px)
     */
    getHeight() {
        return this.elementHeight;
    }
    /**
     * Get notification element width (in px)
     *
     * @return {?} Notification element height (in px)
     */
    getWidth() {
        return this.elementWidth;
    }
    /**
     * Get notification shift offset (in px)
     *
     * @return {?} Notification element shift offset (in px)
     */
    getShift() {
        return this.elementShift;
    }
    /**
     * Show (animate in) this notification
     *
     * @return {?} Promise, resolved when done
     */
    show() {
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        (resolve, reject) => {
            // Are animations enabled?
            if (this.config.animations.enabled && this.config.animations.show.speed > 0) {
                // Get animation data
                /** @type {?} */
                const animationData = this.animationService.getAnimationData('show', this.notification);
                // Set initial styles (styles before animation), prevents quick flicker when animation starts
                /** @type {?} */
                const animatedProperties = Object.keys(animationData.keyframes[0]);
                for (let i = animatedProperties.length - 1; i >= 0; i--) {
                    this.renderer.setStyle(this.element, animatedProperties[i], animationData.keyframes[0][animatedProperties[i]]);
                }
                // Animate notification in
                this.renderer.setStyle(this.element, 'visibility', 'visible');
                /** @type {?} */
                const animation = this.element.animate(animationData.keyframes, animationData.options);
                animation.onfinish = (/**
                 * @return {?}
                 */
                () => {
                    this.startAutoHideTimer();
                    resolve(); // Done
                });
            }
            else {
                // Show notification
                this.renderer.setStyle(this.element, 'visibility', 'visible');
                this.startAutoHideTimer();
                resolve(); // Done
            }
        }));
    }
    /**
     * Hide (animate out) this notification
     *
     * @return {?} Promise, resolved when done
     */
    hide() {
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        (resolve, reject) => {
            this.stopAutoHideTimer();
            // Are animations enabled?
            if (this.config.animations.enabled && this.config.animations.hide.speed > 0) {
                /** @type {?} */
                const animationData = this.animationService.getAnimationData('hide', this.notification);
                /** @type {?} */
                const animation = this.element.animate(animationData.keyframes, animationData.options);
                animation.onfinish = (/**
                 * @return {?}
                 */
                () => {
                    resolve(); // Done
                });
            }
            else {
                resolve(); // Done
            }
        }));
    }
    /**
     * Shift (move) this notification
     *
     * @param {?} distance         Distance to shift (in px)
     * @param {?} shiftToMakePlace Flag, defining in which direction to shift
     * @return {?} Promise, resolved when done
     */
    shift(distance, shiftToMakePlace) {
        return new Promise((/**
         * @param {?} resolve
         * @param {?} reject
         * @return {?}
         */
        (resolve, reject) => {
            // Calculate new position (position after the shift)
            /** @type {?} */
            let newElementShift;
            if ((this.config.position.vertical.position === 'top' && shiftToMakePlace)
                || (this.config.position.vertical.position === 'bottom' && !shiftToMakePlace)) {
                newElementShift = this.elementShift + distance + this.config.position.vertical.gap;
            }
            else {
                newElementShift = this.elementShift - distance - this.config.position.vertical.gap;
            }
            /** @type {?} */
            const horizontalPosition = this.config.position.horizontal.position === 'middle' ? '-50%' : '0';
            // Are animations enabled?
            if (this.config.animations.enabled && this.config.animations.shift.speed > 0) {
                /** @type {?} */
                const animationData = {
                    // TODO: Extract into animation service
                    keyframes: [
                        {
                            transform: `translate3d( ${horizontalPosition}, ${this.elementShift}px, 0 )`
                        },
                        {
                            transform: `translate3d( ${horizontalPosition}, ${newElementShift}px, 0 )`
                        }
                    ],
                    options: {
                        duration: this.config.animations.shift.speed,
                        easing: this.config.animations.shift.easing,
                        fill: 'forwards'
                    }
                };
                this.elementShift = newElementShift;
                /** @type {?} */
                const animation = this.element.animate(animationData.keyframes, animationData.options);
                animation.onfinish = (/**
                 * @return {?}
                 */
                () => {
                    resolve(); // Done
                });
            }
            else {
                this.renderer.setStyle(this.element, 'transform', `translate3d( ${horizontalPosition}, ${newElementShift}px, 0 )`);
                this.elementShift = newElementShift;
                resolve(); // Done
            }
        }));
    }
    /**
     * Handle click on dismiss button
     * @return {?}
     */
    onClickDismiss() {
        this.dismiss.emit(this.notification.id);
    }
    /**
     * Handle mouseover over notification area
     * @return {?}
     */
    onNotificationMouseover() {
        if (this.config.behaviour.onMouseover === 'pauseAutoHide') {
            this.pauseAutoHideTimer();
        }
        else if (this.config.behaviour.onMouseover === 'resetAutoHide') {
            this.stopAutoHideTimer();
        }
    }
    /**
     * Handle mouseout from notification area
     * @return {?}
     */
    onNotificationMouseout() {
        if (this.config.behaviour.onMouseover === 'pauseAutoHide') {
            this.continueAutoHideTimer();
        }
        else if (this.config.behaviour.onMouseover === 'resetAutoHide') {
            this.startAutoHideTimer();
        }
    }
    /**
     * Handle click on notification area
     * @return {?}
     */
    onNotificationClick() {
        if (this.config.behaviour.onClick === 'hide') {
            this.onClickDismiss();
        }
    }
    /**
     * Start the auto hide timer (if enabled)
     * @private
     * @return {?}
     */
    startAutoHideTimer() {
        if (this.config.behaviour.autoHide !== false && this.config.behaviour.autoHide > 0) {
            this.timerService.start(this.config.behaviour.autoHide).then((/**
             * @return {?}
             */
            () => {
                this.onClickDismiss();
            }));
        }
    }
    /**
     * Pause the auto hide timer (if enabled)
     * @private
     * @return {?}
     */
    pauseAutoHideTimer() {
        if (this.config.behaviour.autoHide !== false && this.config.behaviour.autoHide > 0) {
            this.timerService.pause();
        }
    }
    /**
     * Continue the auto hide timer (if enabled)
     * @private
     * @return {?}
     */
    continueAutoHideTimer() {
        if (this.config.behaviour.autoHide !== false && this.config.behaviour.autoHide > 0) {
            this.timerService.continue();
        }
    }
    /**
     * Stop the auto hide timer (if enabled)
     * @private
     * @return {?}
     */
    stopAutoHideTimer() {
        if (this.config.behaviour.autoHide !== false && this.config.behaviour.autoHide > 0) {
            this.timerService.stop();
        }
    }
    /**
     * Initial notification setup
     * @private
     * @return {?}
     */
    setup() {
        // Set start position (initially the exact same for every new notification)
        if (this.config.position.horizontal.position === 'left') {
            this.renderer.setStyle(this.element, 'left', `${this.config.position.horizontal.distance}px`);
        }
        else if (this.config.position.horizontal.position === 'right') {
            this.renderer.setStyle(this.element, 'right', `${this.config.position.horizontal.distance}px`);
        }
        else {
            this.renderer.setStyle(this.element, 'left', '50%');
            // Let's get the GPU handle some work as well (#perfmatters)
            this.renderer.setStyle(this.element, 'transform', 'translate3d( -50%, 0, 0 )');
        }
        if (this.config.position.vertical.position === 'top') {
            this.renderer.setStyle(this.element, 'top', `${this.config.position.vertical.distance}px`);
        }
        else {
            this.renderer.setStyle(this.element, 'bottom', `${this.config.position.vertical.distance}px`);
        }
        // Add classes (responsible for visual design)
        this.renderer.addClass(this.element, `notifier__notification--${this.notification.type}`);
        this.renderer.addClass(this.element, `notifier__notification--${this.config.theme}`);
    }
}
NotifierNotificationComponent.decorators = [
    { type: Component, args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                // (#perfmatters)
                host: {
                    '(click)': 'onNotificationClick()',
                    '(mouseout)': 'onNotificationMouseout()',
                    '(mouseover)': 'onNotificationMouseover()',
                    class: 'notifier__notification'
                },
                providers: [
                    // We provide the timer to the component's local injector, so that every notification components gets its own
                    // instance of the timer service, thus running their timers independently from each other
                    NotifierTimerService
                ],
                selector: 'notifier-notification',
                template: "<ng-container *ngIf=\"notification.template; else predefinedNotification\" [ngTemplateOutlet]=\"notification.template\" [ngTemplateOutletContext]=\"{ notification: notification }\">\n</ng-container>\n\n<ng-template #predefinedNotification>\n\t<p class=\"notifier__notification-message\">{{ notification.message }}</p>\n\t<button class=\"notifier__notification-button\" type=\"button\" title=\"dismiss\" *ngIf=\"config.behaviour.showDismissButton\" (click)=\"onClickDismiss()\">\n\t\t<svg class=\"notifier__notification-button-icon\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\">\n\t\t\t<path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" />\n\t\t</svg>\n\t</button>\n</ng-template>\n"
            }] }
];
/** @nocollapse */
NotifierNotificationComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: NotifierService },
    { type: NotifierTimerService },
    { type: NotifierAnimationService }
];
NotifierNotificationComponent.propDecorators = {
    notification: [{ type: Input }],
    ready: [{ type: Output }],
    dismiss: [{ type: Output }]
};
if (false) {
    /**
     * Input: Notification object, contains all details necessary to construct the notification
     * @type {?}
     */
    NotifierNotificationComponent.prototype.notification;
    /**
     * Output: Ready event, handles the initialization success by emitting a reference to this notification component
     * @type {?}
     */
    NotifierNotificationComponent.prototype.ready;
    /**
     * Output: Dismiss event, handles the click on the dismiss button by emitting the notification ID of this notification component
     * @type {?}
     */
    NotifierNotificationComponent.prototype.dismiss;
    /**
     * Notifier configuration
     * @type {?}
     */
    NotifierNotificationComponent.prototype.config;
    /**
     * Notifier timer service
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.timerService;
    /**
     * Notifier animation service
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.animationService;
    /**
     * Angular renderer, used to preserve the overall DOM abstraction & independence
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.renderer;
    /**
     * Native element reference, used for manipulating DOM properties
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.element;
    /**
     * Current notification height, calculated and cached here (#perfmatters)
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.elementHeight;
    /**
     * Current notification width, calculated and cached here (#perfmatters)
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.elementWidth;
    /**
     * Current notification shift, calculated and cached here (#perfmatters)
     * @type {?}
     * @private
     */
    NotifierNotificationComponent.prototype.elementShift;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWZpZXItbm90aWZpY2F0aW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItbm90aWZpZXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9ub3RpZmllci1ub3RpZmljYXRpb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQWlCLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBR3RJLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBRWxGLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHVDQUF1QyxDQUFDO0FBQzdFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQzs7Ozs7Ozs7O0FBMEIxRSxNQUFNLE9BQU8sNkJBQTZCOzs7Ozs7Ozs7O0lBcUV6QyxZQUFvQixVQUFzQixFQUFFLFFBQW1CLEVBQUUsZUFBZ0MsRUFDaEcsb0JBQTBDLEVBQUUsd0JBQWtEO1FBQzlGLElBQUksQ0FBQyxNQUFNLEdBQUcsZUFBZSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQzFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxZQUFZLEVBQWlDLENBQUM7UUFDL0QsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBQzFDLElBQUksQ0FBQyxZQUFZLEdBQUcsb0JBQW9CLENBQUM7UUFDekMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLHdCQUF3QixDQUFDO1FBQ2pELElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxPQUFPLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQztRQUN4QyxJQUFJLENBQUMsWUFBWSxH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QUFZLENBQUMsSUFBSyxFQUFFLENBQUUsQ0FBQztRQUM5RixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBRSxJQUFJLENBQUMsT0FBTyxFQUFFLDJCQUE0QixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQU0sRUFBRSxDQUFFLENBQUM7SUFFMUYsQ0FBQzs7O1lBM1dELFNBQVMsU0FBRTtnQkFDWCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTs7Z0JBQy9DLElBQUksRUFBRTtvQkFDTCxTQUFTLEVBQUUsdUJBQXVCO29CQUNsQyxZQUFZLEVBQUUsMEJBQTBCO29CQUN4QyxhQUFhLEVBQUUsMkJBQTJCO29CQUMxQyxLQUFLLEVBQUUsd0JBQXdCO2lCQUMvQjtnQkFDRCxTQUFTLEVBQUU7b0JBQ1YsNkdBQTZHO29CQUM3Ryx5RkFBeUY7b0JBQ3pGLG9CQUFvQjtpQkFDcEI7Z0JBQ0QsUUFBUSxFQUFFLHVCQUF1QjtnQkFDakMseXZCQUFxRDthQUNyRDs7OztZQWhDMkQsVUFBVTtZQUErQixTQUFTO1lBTXJHLGVBQWU7WUFDZixvQkFBb0I7WUFKcEIsd0JBQXdCOzs7MkJBbUMvQixLQUFLO29CQU1MLE1BQU07c0JBTU4sTUFBTTs7Ozs7OztJQVpQLHFEQUMwQzs7Ozs7SUFLMUMsOENBQzBEOzs7OztJQUsxRCxnREFDcUM7Ozs7O0lBS3JDLCtDQUF1Qzs7Ozs7O0lBS3ZDLHFEQUFvRDs7Ozs7O0lBS3BELHlEQUE0RDs7Ozs7O0lBSzVELGlEQUFxQzs7Ozs7O0lBS3JDLGdEQUFzQzs7Ozs7O0lBS3RDLHNEQUE4Qjs7Ozs7O0lBSzlCLHFEQUE2Qjs7Ozs7O0lBSzdCLHFEQUE2QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFmdGVyVmlld0luaXQsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IE5vdGlmaWVyQW5pbWF0aW9uRGF0YSB9IGZyb20gJy4uL21vZGVscy9ub3RpZmllci1hbmltYXRpb24ubW9kZWwnO1xuaW1wb3J0IHsgTm90aWZpZXJBbmltYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbm90aWZpZXItYW5pbWF0aW9uLnNlcnZpY2UnO1xuaW1wb3J0IHsgTm90aWZpZXJDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvbm90aWZpZXItY29uZmlnLm1vZGVsJztcbmltcG9ydCB7IE5vdGlmaWVyTm90aWZpY2F0aW9uIH0gZnJvbSAnLi4vbW9kZWxzL25vdGlmaWVyLW5vdGlmaWNhdGlvbi5tb2RlbCc7XG5pbXBvcnQgeyBOb3RpZmllclNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9ub3RpZmllci5zZXJ2aWNlJztcbmltcG9ydCB7IE5vdGlmaWVyVGltZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbm90aWZpZXItdGltZXIuc2VydmljZSc7XG5cbi8qKlxuICogTm90aWZpZXIgbm90aWZpY2F0aW9uIGNvbXBvbmVudFxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogVGhpcyBjb21wb25lbnQgaXMgcmVzcG9uc2libGUgZm9yIGFjdHVhbGx5IGRpc3BsYXlpbmcgdGhlIG5vdGlmaWNhdGlvbiBvbiBzY3JlZW4uIEluIGFkZGl0aW9uLCBpdCdzIGFibGUgdG8gc2hvdyBhbmQgaGlkZSB0aGlzXG4gKiBub3RpZmljYXRpb24sIGluIHBhcnRpY3VsYXIgdG8gYW5pbWF0ZSB0aGlzIG5vdGlmaWNhdGlvbiBpbiBhbmQgb3V0LCBhcyB3ZWxsIGFzIHNoaWZ0IChtb3ZlKSB0aGlzIG5vdGlmaWNhdGlvbiB2ZXJ0aWNhbGx5IGFyb3VuZC5cbiAqIEZ1cnRoZXJtb3JlLCB0aGUgbm90aWZpY2F0aW9uIGNvbXBvbmVudCBoYW5kbGVzIGFsbCBpbnRlcmFjdGlvbnMgdGhlIHVzZXIgaGFzIHdpdGggdGhpcyBub3RpZmljYXRpb24gLyBjb21wb25lbnQsIHN1Y2ggYXMgY2xpY2tzIGFuZFxuICogbW91c2UgbW92ZW1lbnRzLlxuICovXG5AQ29tcG9uZW50KCB7XG5cdGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLCAvLyAoI3BlcmZtYXR0ZXJzKVxuXHRob3N0OiB7XG5cdFx0JyhjbGljayknOiAnb25Ob3RpZmljYXRpb25DbGljaygpJyxcblx0XHQnKG1vdXNlb3V0KSc6ICdvbk5vdGlmaWNhdGlvbk1vdXNlb3V0KCknLFxuXHRcdCcobW91c2VvdmVyKSc6ICdvbk5vdGlmaWNhdGlvbk1vdXNlb3ZlcigpJyxcblx0XHRjbGFzczogJ25vdGlmaWVyX19ub3RpZmljYXRpb24nXG5cdH0sXG5cdHByb3ZpZGVyczogW1xuXHRcdC8vIFdlIHByb3ZpZGUgdGhlIHRpbWVyIHRvIHRoZSBjb21wb25lbnQncyBsb2NhbCBpbmplY3Rvciwgc28gdGhhdCBldmVyeSBub3RpZmljYXRpb24gY29tcG9uZW50cyBnZXRzIGl0cyBvd25cblx0XHQvLyBpbnN0YW5jZSBvZiB0aGUgdGltZXIgc2VydmljZSwgdGh1cyBydW5uaW5nIHRoZWlyIHRpbWVycyBpbmRlcGVuZGVudGx5IGZyb20gZWFjaCBvdGhlclxuXHRcdE5vdGlmaWVyVGltZXJTZXJ2aWNlXG5cdF0sXG5cdHNlbGVjdG9yOiAnbm90aWZpZXItbm90aWZpY2F0aW9uJyxcblx0dGVtcGxhdGVVcmw6ICcuL25vdGlmaWVyLW5vdGlmaWNhdGlvbi5jb21wb25lbnQuaHRtbCdcbn0gKVxuZXhwb3J0IGNsYXNzIE5vdGlmaWVyTm90aWZpY2F0aW9uQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCB7XG5cblx0LyoqXG5cdCAqIElucHV0OiBOb3RpZmljYXRpb24gb2JqZWN0LCBjb250YWlucyBhbGwgZGV0YWlscyBuZWNlc3NhcnkgdG8gY29uc3RydWN0IHRoZSBub3RpZmljYXRpb25cblx0ICovXG5cdEBJbnB1dCgpXG5cdHB1YmxpYyBub3RpZmljYXRpb246IE5vdGlmaWVyTm90aWZpY2F0aW9uO1xuXG5cdC8qKlxuXHQgKiBPdXRwdXQ6IFJlYWR5IGV2ZW50LCBoYW5kbGVzIHRoZSBpbml0aWFsaXphdGlvbiBzdWNjZXNzIGJ5IGVtaXR0aW5nIGEgcmVmZXJlbmNlIHRvIHRoaXMgbm90aWZpY2F0aW9uIGNvbXBvbmVudFxuXHQgKi9cblx0QE91dHB1dCgpXG5cdHB1YmxpYyByZWFkeTogRXZlbnRFbWl0dGVyPE5vdGlmaWVyTm90aWZpY2F0aW9uQ29tcG9uZW50PjtcblxuXHQvKipcblx0ICogT3V0cHV0OiBEaXNtaXNzIGV2ZW50LCBoYW5kbGVzIHRoZSBjbGljayBvbiB0aGUgZGlzbWlzcyBidXR0b24gYnkgZW1pdHRpbmcgdGhlIG5vdGlmaWNhdGlvbiBJRCBvZiB0aGlzIG5vdGlmaWNhdGlvbiBjb21wb25lbnRcblx0ICovXG5cdEBPdXRwdXQoKVxuXHRwdWJsaWMgZGlzbWlzczogRXZlbnRFbWl0dGVyPHN0cmluZz47XG5cblx0LyoqXG5cdCAqIE5vdGlmaWVyIGNvbmZpZ3VyYXRpb25cblx0ICovXG5cdHB1YmxpYyByZWFkb25seSBjb25maWc6IE5vdGlmaWVyQ29uZmlnO1xuXG5cdC8qKlxuXHQgKiBOb3RpZmllciB0aW1lciBzZXJ2aWNlXG5cdCAqL1xuXHRwcml2YXRlIHJlYWRvbmx5IHRpbWVyU2VydmljZTogTm90aWZpZXJUaW1lclNlcnZpY2U7XG5cblx0LyoqXG5cdCAqIE5vdGlmaWVyIGFuaW1hdGlvbiBzZXJ2aWNlXG5cdCAqL1xuXHRwcml2YXRlIHJlYWRvbmx5IGFuaW1hdGlvblNlcnZpY2U6IE5vdGlmaWVyQW5pbWF0aW9uU2VydmljZTtcblxuXHQvKipcblx0ICogQW5ndWxhciByZW5kZXJlciwgdXNlZCB0byBwcmVzZXJ2ZSB0aGUgb3ZlcmFsbCBET00gYWJzdHJhY3Rpb24gJiBpbmRlcGVuZGVuY2Vcblx0ICovXG5cdHByaXZhdGUgcmVhZG9ubHkgcmVuZGVyZXI6IFJlbmRlcmVyMjtcblxuXHQvKipcblx0ICogTmF0aXZlIGVsZW1lbnQgcmVmZXJlbmNlLCB1c2VkIGZvciBtYW5pcHVsYXRpbmcgRE9NIHByb3BlcnRpZXNcblx0ICovXG5cdHByaXZhdGUgcmVhZG9ubHkgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG5cblx0LyoqXG5cdCAqIEN1cnJlbnQgbm90aWZpY2F0aW9uIGhlaWdodCwgY2FsY3VsYXRlZCBhbmQgY2FjaGVkIGhlcmUgKCNwZXJmbWF0dGVycylcblx0ICovXG5cdHByaXZhdGUgZWxlbWVudEhlaWdodDogbnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBDdXJyZW50IG5vdGlmaWNhdGlvbiB3aWR0aCwgY2FsY3VsYXRlZCBhbmQgY2FjaGVkIGhlcmUgKCNwZXJmbWF0dGVycylcblx0ICovXG5cdHByaXZhdGUgZWxlbWVudFdpZHRoOiBudW1iZXI7XG5cblx0LyoqXG5cdCAqIEN1cnJlbnQgbm90aWZpY2F0aW9uIHNoaWZ0LCBjYWxjdWxhdGVkIGFuZCBjYWNoZWQgaGVyZSAoI3BlcmZtYXR0ZXJzKVxuXHQgKi9cblx0cHJpdmF0ZSBlbGVtZW50U2hpZnQ6IG51bWJlcjtcblxuXHQvKipcblx0ICogQ29uc3RydWN0b3Jcblx0ICpcblx0ICogQHBhcmFtIGVsZW1lbnRSZWYgICAgICAgICAgICAgICBSZWZlcmVuY2UgdG8gdGhlIGNvbXBvbmVudCdzIGVsZW1lbnRcblx0ICogQHBhcmFtIHJlbmRlcmVyICAgICAgICAgICAgICAgICBBbmd1bGFyIHJlbmRlcmVyXG5cdCAqIEBwYXJhbSBub3RpZmllclNlcnZpY2UgICAgICAgICAgTm90aWZpZXIgc2VydmljZVxuXHQgKiBAcGFyYW0gbm90aWZpZXJUaW1lclNlcnZpY2UgICAgIE5vdGlmaWVyIHRpbWVyIHNlcnZpY2Vcblx0ICogQHBhcmFtIG5vdGlmaWVyQW5pbWF0aW9uU2VydmljZSBOb3RpZmllciBhbmltYXRpb24gc2VydmljZVxuXHQgKi9cblx0cHVibGljIGNvbnN0cnVjdG9yKCBlbGVtZW50UmVmOiBFbGVtZW50UmVmLCByZW5kZXJlcjogUmVuZGVyZXIyLCBub3RpZmllclNlcnZpY2U6IE5vdGlmaWVyU2VydmljZSxcblx0XHRub3RpZmllclRpbWVyU2VydmljZTogTm90aWZpZXJUaW1lclNlcnZpY2UsIG5vdGlmaWVyQW5pbWF0aW9uU2VydmljZTogTm90aWZpZXJBbmltYXRpb25TZXJ2aWNlICkge1xuXHRcdHRoaXMuY29uZmlnID0gbm90aWZpZXJTZXJ2aWNlLmdldENvbmZpZygpO1xuXHRcdHRoaXMucmVhZHkgPSBuZXcgRXZlbnRFbWl0dGVyPE5vdGlmaWVyTm90aWZpY2F0aW9uQ29tcG9uZW50PigpO1xuXHRcdHRoaXMuZGlzbWlzcyA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuXHRcdHRoaXMudGltZXJTZXJ2aWNlID0gbm90aWZpZXJUaW1lclNlcnZpY2U7XG5cdFx0dGhpcy5hbmltYXRpb25TZXJ2aWNlID0gbm90aWZpZXJBbmltYXRpb25TZXJ2aWNlO1xuXHRcdHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XG5cdFx0dGhpcy5lbGVtZW50U2hpZnQgPSAwO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbXBvbmVudCBhZnRlciB2aWV3IGluaXQgbGlmZWN5Y2xlIGhvb2ssIHNldHRzIHVwIHRoZSBjb21wb25lbnQgYW5kIHRoZW4gZW1pdHMgdGhlIHJlYWR5IGV2ZW50XG5cdCAqL1xuXHRwdWJsaWMgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuXHRcdHRoaXMuc2V0dXAoKTtcblx0XHR0aGlzLmVsZW1lbnRIZWlnaHQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXHRcdHRoaXMuZWxlbWVudFdpZHRoID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xuXHRcdHRoaXMucmVhZHkuZW1pdCggdGhpcyApO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCB0aGUgbm90aWZpZXIgY29uZmlnXG5cdCAqXG5cdCAqIEByZXR1cm5zIE5vdGlmaWVyIGNvbmZpZ3VyYXRpb25cblx0ICovXG5cdHB1YmxpYyBnZXRDb25maWcoKTogTm90aWZpZXJDb25maWcge1xuXHRcdHJldHVybiB0aGlzLmNvbmZpZztcblx0fVxuXG5cdC8qKlxuXHQgKiBHZXQgbm90aWZpY2F0aW9uIGVsZW1lbnQgaGVpZ2h0IChpbiBweClcblx0ICpcblx0ICogQHJldHVybnMgTm90aWZpY2F0aW9uIGVsZW1lbnQgaGVpZ2h0IChpbiBweClcblx0ICovXG5cdHB1YmxpYyBnZXRIZWlnaHQoKTogbnVtYmVyIHtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50SGVpZ2h0O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBub3RpZmljYXRpb24gZWxlbWVudCB3aWR0aCAoaW4gcHgpXG5cdCAqXG5cdCAqIEByZXR1cm5zIE5vdGlmaWNhdGlvbiBlbGVtZW50IGhlaWdodCAoaW4gcHgpXG5cdCAqL1xuXHRwdWJsaWMgZ2V0V2lkdGgoKTogbnVtYmVyIHtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50V2lkdGg7XG5cdH1cblxuXHQvKipcblx0ICogR2V0IG5vdGlmaWNhdGlvbiBzaGlmdCBvZmZzZXQgKGluIHB4KVxuXHQgKlxuXHQgKiBAcmV0dXJucyBOb3RpZmljYXRpb24gZWxlbWVudCBzaGlmdCBvZmZzZXQgKGluIHB4KVxuXHQgKi9cblx0cHVibGljIGdldFNoaWZ0KCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudFNoaWZ0O1xuXHR9XG5cblx0LyoqXG5cdCAqIFNob3cgKGFuaW1hdGUgaW4pIHRoaXMgbm90aWZpY2F0aW9uXG5cdCAqXG5cdCAqIEByZXR1cm5zIFByb21pc2UsIHJlc29sdmVkIHdoZW4gZG9uZVxuXHQgKi9cblx0cHVibGljIHNob3coKTogUHJvbWlzZTx1bmRlZmluZWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2U8dW5kZWZpbmVkPiggKCByZXNvbHZlOiAoKSA9PiB2b2lkLCByZWplY3Q6ICgpID0+IHZvaWQgKSA9PiB7XG5cblx0XHRcdC8vIEFyZSBhbmltYXRpb25zIGVuYWJsZWQ/XG5cdFx0XHRpZiAoIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuZW5hYmxlZCAmJiB0aGlzLmNvbmZpZy5hbmltYXRpb25zLnNob3cuc3BlZWQgPiAwICkge1xuXG5cdFx0XHRcdC8vIEdldCBhbmltYXRpb24gZGF0YVxuXHRcdFx0XHRjb25zdCBhbmltYXRpb25EYXRhOiBOb3RpZmllckFuaW1hdGlvbkRhdGEgPSB0aGlzLmFuaW1hdGlvblNlcnZpY2UuZ2V0QW5pbWF0aW9uRGF0YSggJ3Nob3cnLCB0aGlzLm5vdGlmaWNhdGlvbiApO1xuXG5cdFx0XHRcdC8vIFNldCBpbml0aWFsIHN0eWxlcyAoc3R5bGVzIGJlZm9yZSBhbmltYXRpb24pLCBwcmV2ZW50cyBxdWljayBmbGlja2VyIHdoZW4gYW5pbWF0aW9uIHN0YXJ0c1xuXHRcdFx0XHRjb25zdCBhbmltYXRlZFByb3BlcnRpZXM6IEFycmF5PHN0cmluZz4gPSBPYmplY3Qua2V5cyggYW5pbWF0aW9uRGF0YS5rZXlmcmFtZXNbIDAgXSApO1xuXHRcdFx0XHRmb3IgKCBsZXQgaTogbnVtYmVyID0gYW5pbWF0ZWRQcm9wZXJ0aWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xuXHRcdFx0XHRcdHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoIHRoaXMuZWxlbWVudCwgYW5pbWF0ZWRQcm9wZXJ0aWVzWyBpIF0sXG5cdFx0XHRcdFx0XHRhbmltYXRpb25EYXRhLmtleWZyYW1lc1sgMCBdWyBhbmltYXRlZFByb3BlcnRpZXNbIGkgXSBdICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBbmltYXRlIG5vdGlmaWNhdGlvbiBpblxuXHRcdFx0XHR0aGlzLnJlbmRlcmVyLnNldFN0eWxlKCB0aGlzLmVsZW1lbnQsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnICk7XG5cdFx0XHRcdGNvbnN0IGFuaW1hdGlvbjogQW5pbWF0aW9uID0gdGhpcy5lbGVtZW50LmFuaW1hdGUoIGFuaW1hdGlvbkRhdGEua2V5ZnJhbWVzLCBhbmltYXRpb25EYXRhLm9wdGlvbnMgKTtcblx0XHRcdFx0YW5pbWF0aW9uLm9uZmluaXNoID0gKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuc3RhcnRBdXRvSGlkZVRpbWVyKCk7XG5cdFx0XHRcdFx0cmVzb2x2ZSgpOyAvLyBEb25lXG5cdFx0XHRcdH07XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gU2hvdyBub3RpZmljYXRpb25cblx0XHRcdFx0dGhpcy5yZW5kZXJlci5zZXRTdHlsZSggdGhpcy5lbGVtZW50LCAndmlzaWJpbGl0eScsICd2aXNpYmxlJyApO1xuXHRcdFx0XHR0aGlzLnN0YXJ0QXV0b0hpZGVUaW1lcigpO1xuXHRcdFx0XHRyZXNvbHZlKCk7IC8vIERvbmVcblxuXHRcdFx0fVxuXG5cdFx0fSApO1xuXG5cdH1cblxuXHQvKipcblx0ICogSGlkZSAoYW5pbWF0ZSBvdXQpIHRoaXMgbm90aWZpY2F0aW9uXG5cdCAqXG5cdCAqIEByZXR1cm5zIFByb21pc2UsIHJlc29sdmVkIHdoZW4gZG9uZVxuXHQgKi9cblx0cHVibGljIGhpZGUoKTogUHJvbWlzZTx1bmRlZmluZWQ+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2U8dW5kZWZpbmVkPiggKCByZXNvbHZlOiAoKSA9PiB2b2lkLCByZWplY3Q6ICgpID0+IHZvaWQgKSA9PiB7XG5cblx0XHRcdHRoaXMuc3RvcEF1dG9IaWRlVGltZXIoKTtcblxuXHRcdFx0Ly8gQXJlIGFuaW1hdGlvbnMgZW5hYmxlZD9cblx0XHRcdGlmICggdGhpcy5jb25maWcuYW5pbWF0aW9ucy5lbmFibGVkICYmIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuaGlkZS5zcGVlZCA+IDAgKSB7XG5cdFx0XHRcdGNvbnN0IGFuaW1hdGlvbkRhdGE6IE5vdGlmaWVyQW5pbWF0aW9uRGF0YSA9IHRoaXMuYW5pbWF0aW9uU2VydmljZS5nZXRBbmltYXRpb25EYXRhKCAnaGlkZScsIHRoaXMubm90aWZpY2F0aW9uICk7XG5cdFx0XHRcdGNvbnN0IGFuaW1hdGlvbjogQW5pbWF0aW9uID0gdGhpcy5lbGVtZW50LmFuaW1hdGUoIGFuaW1hdGlvbkRhdGEua2V5ZnJhbWVzLCBhbmltYXRpb25EYXRhLm9wdGlvbnMgKTtcblx0XHRcdFx0YW5pbWF0aW9uLm9uZmluaXNoID0gKCkgPT4ge1xuXHRcdFx0XHRcdHJlc29sdmUoKTsgLy8gRG9uZVxuXHRcdFx0XHR9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzb2x2ZSgpOyAvLyBEb25lXG5cdFx0XHR9XG5cblx0XHR9ICk7XG5cdH1cblxuXHQvKipcblx0ICogU2hpZnQgKG1vdmUpIHRoaXMgbm90aWZpY2F0aW9uXG5cdCAqXG5cdCAqIEBwYXJhbSAgIGRpc3RhbmNlICAgICAgICAgRGlzdGFuY2UgdG8gc2hpZnQgKGluIHB4KVxuXHQgKiBAcGFyYW0gICBzaGlmdFRvTWFrZVBsYWNlIEZsYWcsIGRlZmluaW5nIGluIHdoaWNoIGRpcmVjdGlvbiB0byBzaGlmdFxuXHQgKiBAcmV0dXJucyBQcm9taXNlLCByZXNvbHZlZCB3aGVuIGRvbmVcblx0ICovXG5cdHB1YmxpYyBzaGlmdCggZGlzdGFuY2U6IG51bWJlciwgc2hpZnRUb01ha2VQbGFjZTogYm9vbGVhbiApOiBQcm9taXNlPHVuZGVmaW5lZD4ge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KCAoIHJlc29sdmU6ICgpID0+IHZvaWQsIHJlamVjdDogKCkgPT4gdm9pZCApID0+IHtcblxuXHRcdFx0Ly8gQ2FsY3VsYXRlIG5ldyBwb3NpdGlvbiAocG9zaXRpb24gYWZ0ZXIgdGhlIHNoaWZ0KVxuXHRcdFx0bGV0IG5ld0VsZW1lbnRTaGlmdDogbnVtYmVyO1xuXHRcdFx0aWYgKCAoIHRoaXMuY29uZmlnLnBvc2l0aW9uLnZlcnRpY2FsLnBvc2l0aW9uID09PSAndG9wJyAmJiBzaGlmdFRvTWFrZVBsYWNlIClcblx0XHRcdFx0fHwgKCB0aGlzLmNvbmZpZy5wb3NpdGlvbi52ZXJ0aWNhbC5wb3NpdGlvbiA9PT0gJ2JvdHRvbScgJiYgIXNoaWZ0VG9NYWtlUGxhY2UgKSApIHtcblx0XHRcdFx0bmV3RWxlbWVudFNoaWZ0ID0gdGhpcy5lbGVtZW50U2hpZnQgKyBkaXN0YW5jZSArIHRoaXMuY29uZmlnLnBvc2l0aW9uLnZlcnRpY2FsLmdhcDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ld0VsZW1lbnRTaGlmdCA9IHRoaXMuZWxlbWVudFNoaWZ0IC0gZGlzdGFuY2UgLSB0aGlzLmNvbmZpZy5wb3NpdGlvbi52ZXJ0aWNhbC5nYXA7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBob3Jpem9udGFsUG9zaXRpb246IHN0cmluZyA9IHRoaXMuY29uZmlnLnBvc2l0aW9uLmhvcml6b250YWwucG9zaXRpb24gPT09ICdtaWRkbGUnID8gJy01MCUnIDogJzAnO1xuXG5cdFx0XHQvLyBBcmUgYW5pbWF0aW9ucyBlbmFibGVkP1xuXHRcdFx0aWYgKCB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmVuYWJsZWQgJiYgdGhpcy5jb25maWcuYW5pbWF0aW9ucy5zaGlmdC5zcGVlZCA+IDAgKSB7XG5cdFx0XHRcdGNvbnN0IGFuaW1hdGlvbkRhdGE6IE5vdGlmaWVyQW5pbWF0aW9uRGF0YSA9IHsgLy8gVE9ETzogRXh0cmFjdCBpbnRvIGFuaW1hdGlvbiBzZXJ2aWNlXG5cdFx0XHRcdFx0a2V5ZnJhbWVzOiBbXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHRyYW5zZm9ybTogYHRyYW5zbGF0ZTNkKCAkeyBob3Jpem9udGFsUG9zaXRpb24gfSwgJHsgdGhpcy5lbGVtZW50U2hpZnQgfXB4LCAwIClgXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHR0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCggJHsgaG9yaXpvbnRhbFBvc2l0aW9uIH0sICR7IG5ld0VsZW1lbnRTaGlmdCB9cHgsIDAgKWBcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRdLFxuXHRcdFx0XHRcdG9wdGlvbnM6IHtcblx0XHRcdFx0XHRcdGR1cmF0aW9uOiB0aGlzLmNvbmZpZy5hbmltYXRpb25zLnNoaWZ0LnNwZWVkLFxuXHRcdFx0XHRcdFx0ZWFzaW5nOiB0aGlzLmNvbmZpZy5hbmltYXRpb25zLnNoaWZ0LmVhc2luZyxcblx0XHRcdFx0XHRcdGZpbGw6ICdmb3J3YXJkcydcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoaXMuZWxlbWVudFNoaWZ0ID0gbmV3RWxlbWVudFNoaWZ0O1xuXHRcdFx0XHRjb25zdCBhbmltYXRpb246IEFuaW1hdGlvbiA9IHRoaXMuZWxlbWVudC5hbmltYXRlKCBhbmltYXRpb25EYXRhLmtleWZyYW1lcywgYW5pbWF0aW9uRGF0YS5vcHRpb25zICk7XG5cdFx0XHRcdGFuaW1hdGlvbi5vbmZpbmlzaCA9ICgpID0+IHtcblx0XHRcdFx0XHRyZXNvbHZlKCk7IC8vIERvbmVcblx0XHRcdFx0fTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZW5kZXJlci5zZXRTdHlsZSggdGhpcy5lbGVtZW50LCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKCAkeyBob3Jpem9udGFsUG9zaXRpb24gfSwgJHsgbmV3RWxlbWVudFNoaWZ0IH1weCwgMCApYCApO1xuXHRcdFx0XHR0aGlzLmVsZW1lbnRTaGlmdCA9IG5ld0VsZW1lbnRTaGlmdDtcblx0XHRcdFx0cmVzb2x2ZSgpOyAvLyBEb25lXG5cdFx0XHR9XG5cblx0XHR9ICk7XG5cblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgY2xpY2sgb24gZGlzbWlzcyBidXR0b25cblx0ICovXG5cdHB1YmxpYyBvbkNsaWNrRGlzbWlzcygpOiB2b2lkIHtcblx0XHR0aGlzLmRpc21pc3MuZW1pdCggdGhpcy5ub3RpZmljYXRpb24uaWQgKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBIYW5kbGUgbW91c2VvdmVyIG92ZXIgbm90aWZpY2F0aW9uIGFyZWFcblx0ICovXG5cdHB1YmxpYyBvbk5vdGlmaWNhdGlvbk1vdXNlb3ZlcigpOiB2b2lkIHtcblx0XHRpZiAoIHRoaXMuY29uZmlnLmJlaGF2aW91ci5vbk1vdXNlb3ZlciA9PT0gJ3BhdXNlQXV0b0hpZGUnICkge1xuXHRcdFx0dGhpcy5wYXVzZUF1dG9IaWRlVGltZXIoKTtcblx0XHR9IGVsc2UgaWYgKCB0aGlzLmNvbmZpZy5iZWhhdmlvdXIub25Nb3VzZW92ZXIgPT09ICdyZXNldEF1dG9IaWRlJyApIHtcblx0XHRcdHRoaXMuc3RvcEF1dG9IaWRlVGltZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIG1vdXNlb3V0IGZyb20gbm90aWZpY2F0aW9uIGFyZWFcblx0ICovXG5cdHB1YmxpYyBvbk5vdGlmaWNhdGlvbk1vdXNlb3V0KCk6IHZvaWQge1xuXHRcdGlmICggdGhpcy5jb25maWcuYmVoYXZpb3VyLm9uTW91c2VvdmVyID09PSAncGF1c2VBdXRvSGlkZScgKSB7XG5cdFx0XHR0aGlzLmNvbnRpbnVlQXV0b0hpZGVUaW1lcigpO1xuXHRcdH0gZWxzZSBpZiAoIHRoaXMuY29uZmlnLmJlaGF2aW91ci5vbk1vdXNlb3ZlciA9PT0gJ3Jlc2V0QXV0b0hpZGUnICkge1xuXHRcdFx0dGhpcy5zdGFydEF1dG9IaWRlVGltZXIoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSGFuZGxlIGNsaWNrIG9uIG5vdGlmaWNhdGlvbiBhcmVhXG5cdCAqL1xuXHRwdWJsaWMgb25Ob3RpZmljYXRpb25DbGljaygpOiB2b2lkIHtcblx0XHRpZiAoIHRoaXMuY29uZmlnLmJlaGF2aW91ci5vbkNsaWNrID09PSAnaGlkZScgKSB7XG5cdFx0XHR0aGlzLm9uQ2xpY2tEaXNtaXNzKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFN0YXJ0IHRoZSBhdXRvIGhpZGUgdGltZXIgKGlmIGVuYWJsZWQpXG5cdCAqL1xuXHRwcml2YXRlIHN0YXJ0QXV0b0hpZGVUaW1lcigpOiB2b2lkIHtcblx0XHRpZiAoIHRoaXMuY29uZmlnLmJlaGF2aW91ci5hdXRvSGlkZSAhPT0gZmFsc2UgJiYgdGhpcy5jb25maWcuYmVoYXZpb3VyLmF1dG9IaWRlID4gMCApIHtcblx0XHRcdHRoaXMudGltZXJTZXJ2aWNlLnN0YXJ0KCB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuYXV0b0hpZGUgKS50aGVuKCAoKSA9PiB7XG5cdFx0XHRcdHRoaXMub25DbGlja0Rpc21pc3MoKTtcblx0XHRcdH0gKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogUGF1c2UgdGhlIGF1dG8gaGlkZSB0aW1lciAoaWYgZW5hYmxlZClcblx0ICovXG5cdHByaXZhdGUgcGF1c2VBdXRvSGlkZVRpbWVyKCk6IHZvaWQge1xuXHRcdGlmICggdGhpcy5jb25maWcuYmVoYXZpb3VyLmF1dG9IaWRlICE9PSBmYWxzZSAmJiB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuYXV0b0hpZGUgPiAwICkge1xuXHRcdFx0dGhpcy50aW1lclNlcnZpY2UucGF1c2UoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQ29udGludWUgdGhlIGF1dG8gaGlkZSB0aW1lciAoaWYgZW5hYmxlZClcblx0ICovXG5cdHByaXZhdGUgY29udGludWVBdXRvSGlkZVRpbWVyKCk6IHZvaWQge1xuXHRcdGlmICggdGhpcy5jb25maWcuYmVoYXZpb3VyLmF1dG9IaWRlICE9PSBmYWxzZSAmJiB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuYXV0b0hpZGUgPiAwICkge1xuXHRcdFx0dGhpcy50aW1lclNlcnZpY2UuY29udGludWUoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogU3RvcCB0aGUgYXV0byBoaWRlIHRpbWVyIChpZiBlbmFibGVkKVxuXHQgKi9cblx0cHJpdmF0ZSBzdG9wQXV0b0hpZGVUaW1lcigpOiB2b2lkIHtcblx0XHRpZiAoIHRoaXMuY29uZmlnLmJlaGF2aW91ci5hdXRvSGlkZSAhPT0gZmFsc2UgJiYgdGhpcy5jb25maWcuYmVoYXZpb3VyLmF1dG9IaWRlID4gMCApIHtcblx0XHRcdHRoaXMudGltZXJTZXJ2aWNlLnN0b3AoKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbCBub3RpZmljYXRpb24gc2V0dXBcblx0ICovXG5cdHByaXZhdGUgc2V0dXAoKTogdm9pZCB7XG5cblx0XHQvLyBTZXQgc3RhcnQgcG9zaXRpb24gKGluaXRpYWxseSB0aGUgZXhhY3Qgc2FtZSBmb3IgZXZlcnkgbmV3IG5vdGlmaWNhdGlvbilcblx0XHRpZiAoIHRoaXMuY29uZmlnLnBvc2l0aW9uLmhvcml6b250YWwucG9zaXRpb24gPT09ICdsZWZ0JyApIHtcblx0XHRcdHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoIHRoaXMuZWxlbWVudCwgJ2xlZnQnLCBgJHsgdGhpcy5jb25maWcucG9zaXRpb24uaG9yaXpvbnRhbC5kaXN0YW5jZSB9cHhgICk7XG5cdFx0fSBlbHNlIGlmICggdGhpcy5jb25maWcucG9zaXRpb24uaG9yaXpvbnRhbC5wb3NpdGlvbiA9PT0gJ3JpZ2h0JyApIHtcblx0XHRcdHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoIHRoaXMuZWxlbWVudCwgJ3JpZ2h0JywgYCR7IHRoaXMuY29uZmlnLnBvc2l0aW9uLmhvcml6b250YWwuZGlzdGFuY2UgfXB4YCApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnJlbmRlcmVyLnNldFN0eWxlKCB0aGlzLmVsZW1lbnQsICdsZWZ0JywgJzUwJScgKTtcblx0XHRcdC8vIExldCdzIGdldCB0aGUgR1BVIGhhbmRsZSBzb21lIHdvcmsgYXMgd2VsbCAoI3BlcmZtYXR0ZXJzKVxuXHRcdFx0dGhpcy5yZW5kZXJlci5zZXRTdHlsZSggdGhpcy5lbGVtZW50LCAndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZTNkKCAtNTAlLCAwLCAwICknICk7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5jb25maWcucG9zaXRpb24udmVydGljYWwucG9zaXRpb24gPT09ICd0b3AnICkge1xuXHRcdFx0dGhpcy5yZW5kZXJlci5zZXRTdHlsZSggdGhpcy5lbGVtZW50LCAndG9wJywgYCR7IHRoaXMuY29uZmlnLnBvc2l0aW9uLnZlcnRpY2FsLmRpc3RhbmNlIH1weGAgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5yZW5kZXJlci5zZXRTdHlsZSggdGhpcy5lbGVtZW50LCAnYm90dG9tJywgYCR7IHRoaXMuY29uZmlnLnBvc2l0aW9uLnZlcnRpY2FsLmRpc3RhbmNlIH1weGAgKTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY2xhc3NlcyAocmVzcG9uc2libGUgZm9yIHZpc3VhbCBkZXNpZ24pXG5cdFx0dGhpcy5yZW5kZXJlci5hZGRDbGFzcyggdGhpcy5lbGVtZW50LCBgbm90aWZpZXJfX25vdGlmaWNhdGlvbi0tJHsgdGhpcy5ub3RpZmljYXRpb24udHlwZSB9YCApO1xuXHRcdHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoIHRoaXMuZWxlbWVudCwgYG5vdGlmaWVyX19ub3RpZmljYXRpb24tLSR7IHRoaXMuY29uZmlnLnRoZW1lIH1gICk7XG5cblx0fVxuXG59XG4iXX0=